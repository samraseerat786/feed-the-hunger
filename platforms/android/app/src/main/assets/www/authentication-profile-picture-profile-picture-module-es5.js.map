{"version":3,"sources":["./src/app/authentication/profile-picture/profile-picture.page.html","./src/app/authentication/profile-picture/profile-picture.module.ts","./src/app/authentication/profile-picture/profile-picture.page.scss","./src/app/authentication/profile-picture/profile-picture.page.ts"],"names":[],"mappings":"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","file":"authentication-profile-picture-profile-picture-module-es5.js","sourcesContent":["module.exports = \"<ion-header class=\\\"ion-text-center\\\">\\r\\n    <ion-toolbar color=\\\"secondary\\\">\\r\\n        <ion-buttons>\\r\\n            <ion-back-button></ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <ion-title>\\r\\n            Upload\\r\\n        </ion-title>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content class=\\\"ion-padding\\\">\\r\\n    <ion-item>\\r\\n        <ion-label>\\r\\n            <ion-row>\\r\\n                <ion-col size=\\\"6\\\">\\r\\n                    <ion-button color=\\\"danger\\\" type=\\\"button\\\" expand=\\\"full\\\" shape=\\\"round\\\" (click)=\\\"takePhoto()\\\">\\r\\n                        <ion-icon name=\\\"camera\\\" color=\\\"secondary\\\"></ion-icon>\\r\\n                    </ion-button>\\r\\n                </ion-col>\\r\\n                <ion-col size=\\\"6\\\">\\r\\n                    <ion-button color=\\\"secondary\\\" type=\\\"button\\\" expand=\\\"full\\\" shape=\\\"round\\\" (click)=\\\"selectPhoto()\\\">\\r\\n                        <ion-icon name=\\\"image\\\" color=\\\"secondary\\\"></ion-icon>\\r\\n                    </ion-button>\\r\\n                </ion-col>\\r\\n            </ion-row>\\r\\n        </ion-label>\\r\\n    </ion-item>\\r\\n    <ion-item *ngIf=\\\"error\\\">\\r\\n        <ion-label>\\r\\n            <strong>{{error}}</strong>\\r\\n        </ion-label>\\r\\n    </ion-item>\\r\\n    <ion-item>\\r\\n        <ion-label>\\r\\n            <img *ngIf=\\\"myPhoto\\\" [src]=\\\"myPhoto\\\" alt=\\\"\\\"/>\\r\\n        </ion-label>\\r\\n    </ion-item>\\r\\n</ion-content>\\r\\n\"","import {NgModule} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {FormsModule} from '@angular/forms';\r\nimport {Routes, RouterModule} from '@angular/router';\r\n\r\nimport {IonicModule} from '@ionic/angular';\r\n\r\nimport {ProfilePicturePage} from './profile-picture.page';\r\n\r\nconst routes: Routes = [\r\n    {\r\n        path: '',\r\n        component: ProfilePicturePage\r\n    }\r\n];\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        IonicModule,\r\n        RouterModule.forChild(routes)\r\n    ],\r\n    declarations: [ProfilePicturePage]\r\n})\r\nexport class ProfilePicturePageModule {\r\n}\r\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2F1dGhlbnRpY2F0aW9uL3Byb2ZpbGUtcGljdHVyZS9wcm9maWxlLXBpY3R1cmUucGFnZS5zY3NzIn0= */\"","import {ChangeDetectorRef, Component, OnInit} from '@angular/core';\r\nimport {HttpClient} from '@angular/common/http';\r\nimport {LoadingController, ToastController} from '@ionic/angular';\r\nimport {catchError, finalize} from 'rxjs/operators';\r\nimport {throwError} from 'rxjs';\r\nimport {ListService} from '../../services/list.service';\r\n\r\n@Component({\r\n    selector: 'app-profile-picture',\r\n    templateUrl: './profile-picture.page.html',\r\n    styleUrls: ['./profile-picture.page.scss']\r\n})\r\nexport class ProfilePicturePage implements OnInit {\r\n\r\n    public myPhoto: any;\r\n    public error: string;\r\n    private loading: any;\r\n\r\n    constructor(private readonly http: HttpClient,\r\n                private readonly loadingCtrl: LoadingController,\r\n                private readonly toastCtrl: ToastController,\r\n                private service: ListService,\r\n                private readonly changeDetectorRef: ChangeDetectorRef) {\r\n    }\r\n\r\n    takePhoto() {\r\n        const camera: any = navigator['camera'];\r\n        camera.getPicture(imageData => {\r\n            this.myPhoto = this.convertFileSrc(imageData);\r\n            this.changeDetectorRef.detectChanges();\r\n            this.changeDetectorRef.markForCheck();\r\n            this.uploadPhoto(imageData);\r\n        }, error => this.error = JSON.stringify(error), {\r\n            quality: 100,\r\n            destinationType: camera.DestinationType.FILE_URI,\r\n            sourceType: camera.PictureSourceType.CAMERA,\r\n            encodingType: camera.EncodingType.JPEG\r\n        });\r\n    }\r\n\r\n    selectPhoto(): void {\r\n        const camera: any = navigator['camera'];\r\n        camera.getPicture(imageData => {\r\n            this.myPhoto = this.convertFileSrc(imageData);\r\n            this.uploadPhoto(imageData);\r\n        }, error => this.error = JSON.stringify(error), {\r\n            sourceType: camera.PictureSourceType.PHOTOLIBRARY,\r\n            destinationType: camera.DestinationType.FILE_URI,\r\n            quality: 100,\r\n            encodingType: camera.EncodingType.JPEG,\r\n        });\r\n    }\r\n\r\n    private convertFileSrc(url: string): string {\r\n        if (!url) {\r\n            return url;\r\n        }\r\n        if (url.startsWith('/')) {\r\n            return window['WEBVIEW_SERVER_URL'] + '/_app_file_' + url;\r\n        }\r\n        if (url.startsWith('file://')) {\r\n            return window['WEBVIEW_SERVER_URL'] + url.replace('file://', '/_app_file_');\r\n        }\r\n        if (url.startsWith('content://')) {\r\n            return window['WEBVIEW_SERVER_URL'] + url.replace('content:/', '/_app_content_');\r\n        }\r\n        return url;\r\n    }\r\n\r\n    private async uploadPhoto(imageFileUri: any) {\r\n        this.error = null;\r\n        this.loading = await this.loadingCtrl.create({\r\n            message: 'Uploading...'\r\n        });\r\n\r\n        this.loading.present();\r\n\r\n        window['resolveLocalFileSystemURL'](imageFileUri,\r\n            entry => {\r\n                entry['file'](file => this.readFile(file));\r\n            });\r\n    }\r\n\r\n    private readFile(file: any) {\r\n        const reader = new FileReader();\r\n        reader.onloadend = () => {\r\n            const formData = new FormData();\r\n            const imgBlob = new Blob([reader.result], {type: file.type});\r\n            formData.append('file', imgBlob, file.name);\r\n            this.postData(formData);\r\n        };\r\n        reader.readAsArrayBuffer(file);\r\n    }\r\n\r\n    private postData(formData: FormData) {\r\n        this.http.post<boolean>(`${this.service.homeUrl}/upload`, formData)\r\n            .pipe(\r\n                catchError(e => this.handleError(e)),\r\n                finalize(() => this.loading.dismiss())\r\n            )\r\n            .subscribe(ok => this.showToast(ok));\r\n    }\r\n\r\n    private async showToast(ok: boolean | {}) {\r\n        if (ok === true) {\r\n            const toast = await this.toastCtrl.create({\r\n                message: 'Upload successful',\r\n                duration: 3000,\r\n                position: 'top'\r\n            });\r\n            toast.present();\r\n        } else {\r\n            const toast = await this.toastCtrl.create({\r\n                message: 'Upload failed',\r\n                duration: 3000,\r\n                position: 'top'\r\n            });\r\n            toast.present();\r\n        }\r\n    }\r\n\r\n    private handleError(error: any) {\r\n        const errMsg = error.message ? error.message : error.toString();\r\n        this.error = errMsg;\r\n        this.changeDetectorRef.detectChanges();\r\n        return throwError(errMsg);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n    }\r\n}\r\n"],"sourceRoot":""}