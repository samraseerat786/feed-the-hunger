{"version":3,"sources":["./src/app/authentication/profile-picture/profile-picture.page.html","./src/app/authentication/profile-picture/profile-picture.module.ts","./src/app/authentication/profile-picture/profile-picture.page.scss","./src/app/authentication/profile-picture/profile-picture.page.ts"],"names":[],"mappings":"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","file":"authentication-profile-picture-profile-picture-module-es2015.js","sourcesContent":["module.exports = \"<ion-header class=\\\"ion-text-center\\\">\\r\\n    <ion-toolbar color=\\\"secondary\\\">\\r\\n        <ion-buttons>\\r\\n            <ion-back-button></ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <ion-title>\\r\\n            Upload\\r\\n        </ion-title>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content class=\\\"ion-padding\\\">\\r\\n    <ion-item>\\r\\n        <ion-label>\\r\\n            <ion-row>\\r\\n                <ion-col size=\\\"6\\\">\\r\\n                    <ion-button color=\\\"danger\\\" type=\\\"button\\\" expand=\\\"full\\\" shape=\\\"round\\\" (click)=\\\"takePhoto()\\\">\\r\\n                        <ion-icon name=\\\"camera\\\" color=\\\"secondary\\\"></ion-icon>\\r\\n                    </ion-button>\\r\\n                </ion-col>\\r\\n                <ion-col size=\\\"6\\\">\\r\\n                    <ion-button color=\\\"secondary\\\" type=\\\"button\\\" expand=\\\"full\\\" shape=\\\"round\\\" (click)=\\\"selectPhoto()\\\">\\r\\n                        <ion-icon name=\\\"image\\\" color=\\\"secondary\\\"></ion-icon>\\r\\n                    </ion-button>\\r\\n                </ion-col>\\r\\n            </ion-row>\\r\\n        </ion-label>\\r\\n    </ion-item>\\r\\n    <ion-item *ngIf=\\\"error\\\">\\r\\n        <ion-label>\\r\\n            <strong>{{error}}</strong>\\r\\n        </ion-label>\\r\\n    </ion-item>\\r\\n    <ion-item>\\r\\n        <ion-label>\\r\\n            <img *ngIf=\\\"myPhoto\\\" [src]=\\\"myPhoto\\\" alt=\\\"\\\"/>\\r\\n        </ion-label>\\r\\n    </ion-item>\\r\\n</ion-content>\\r\\n\"","import {NgModule} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {FormsModule} from '@angular/forms';\r\nimport {Routes, RouterModule} from '@angular/router';\r\n\r\nimport {IonicModule} from '@ionic/angular';\r\n\r\nimport {ProfilePicturePage} from './profile-picture.page';\r\n\r\nconst routes: Routes = [\r\n    {\r\n        path: '',\r\n        component: ProfilePicturePage\r\n    }\r\n];\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        IonicModule,\r\n        RouterModule.forChild(routes)\r\n    ],\r\n    declarations: [ProfilePicturePage]\r\n})\r\nexport class ProfilePicturePageModule {\r\n}\r\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2F1dGhlbnRpY2F0aW9uL3Byb2ZpbGUtcGljdHVyZS9wcm9maWxlLXBpY3R1cmUucGFnZS5zY3NzIn0= */\"","import {ChangeDetectorRef, Component, OnInit} from '@angular/core';\r\nimport {HttpClient} from '@angular/common/http';\r\nimport {LoadingController, ToastController} from '@ionic/angular';\r\nimport {catchError, finalize} from 'rxjs/operators';\r\nimport {throwError} from 'rxjs';\r\nimport {ListService} from '../../services/list.service';\r\n\r\n@Component({\r\n    selector: 'app-profile-picture',\r\n    templateUrl: './profile-picture.page.html',\r\n    styleUrls: ['./profile-picture.page.scss']\r\n})\r\nexport class ProfilePicturePage implements OnInit {\r\n\r\n    public myPhoto: any;\r\n    public error: string;\r\n    private loading: any;\r\n\r\n    constructor(private readonly http: HttpClient,\r\n                private readonly loadingCtrl: LoadingController,\r\n                private readonly toastCtrl: ToastController,\r\n                private service: ListService,\r\n                private readonly changeDetectorRef: ChangeDetectorRef) {\r\n    }\r\n\r\n    takePhoto() {\r\n        const camera: any = navigator['camera'];\r\n        camera.getPicture(imageData => {\r\n            this.myPhoto = this.convertFileSrc(imageData);\r\n            this.changeDetectorRef.detectChanges();\r\n            this.changeDetectorRef.markForCheck();\r\n            this.uploadPhoto(imageData);\r\n        }, error => this.error = JSON.stringify(error), {\r\n            quality: 100,\r\n            destinationType: camera.DestinationType.FILE_URI,\r\n            sourceType: camera.PictureSourceType.CAMERA,\r\n            encodingType: camera.EncodingType.JPEG\r\n        });\r\n    }\r\n\r\n    selectPhoto(): void {\r\n        const camera: any = navigator['camera'];\r\n        camera.getPicture(imageData => {\r\n            this.myPhoto = this.convertFileSrc(imageData);\r\n            this.uploadPhoto(imageData);\r\n        }, error => this.error = JSON.stringify(error), {\r\n            sourceType: camera.PictureSourceType.PHOTOLIBRARY,\r\n            destinationType: camera.DestinationType.FILE_URI,\r\n            quality: 100,\r\n            encodingType: camera.EncodingType.JPEG,\r\n        });\r\n    }\r\n\r\n    private convertFileSrc(url: string): string {\r\n        if (!url) {\r\n            return url;\r\n        }\r\n        if (url.startsWith('/')) {\r\n            return window['WEBVIEW_SERVER_URL'] + '/_app_file_' + url;\r\n        }\r\n        if (url.startsWith('file://')) {\r\n            return window['WEBVIEW_SERVER_URL'] + url.replace('file://', '/_app_file_');\r\n        }\r\n        if (url.startsWith('content://')) {\r\n            return window['WEBVIEW_SERVER_URL'] + url.replace('content:/', '/_app_content_');\r\n        }\r\n        return url;\r\n    }\r\n\r\n    private async uploadPhoto(imageFileUri: any) {\r\n        this.error = null;\r\n        this.loading = await this.loadingCtrl.create({\r\n            message: 'Uploading...'\r\n        });\r\n\r\n        this.loading.present();\r\n\r\n        window['resolveLocalFileSystemURL'](imageFileUri,\r\n            entry => {\r\n                entry['file'](file => this.readFile(file));\r\n            });\r\n    }\r\n\r\n    private readFile(file: any) {\r\n        const reader = new FileReader();\r\n        reader.onloadend = () => {\r\n            const formData = new FormData();\r\n            const imgBlob = new Blob([reader.result], {type: file.type});\r\n            formData.append('file', imgBlob, file.name);\r\n            this.postData(formData);\r\n        };\r\n        reader.readAsArrayBuffer(file);\r\n    }\r\n\r\n    private postData(formData: FormData) {\r\n        this.http.post<boolean>(`${this.service.homeUrl}/upload`, formData)\r\n            .pipe(\r\n                catchError(e => this.handleError(e)),\r\n                finalize(() => this.loading.dismiss())\r\n            )\r\n            .subscribe(ok => this.showToast(ok));\r\n    }\r\n\r\n    private async showToast(ok: boolean | {}) {\r\n        if (ok === true) {\r\n            const toast = await this.toastCtrl.create({\r\n                message: 'Upload successful',\r\n                duration: 3000,\r\n                position: 'top'\r\n            });\r\n            toast.present();\r\n        } else {\r\n            const toast = await this.toastCtrl.create({\r\n                message: 'Upload failed',\r\n                duration: 3000,\r\n                position: 'top'\r\n            });\r\n            toast.present();\r\n        }\r\n    }\r\n\r\n    private handleError(error: any) {\r\n        const errMsg = error.message ? error.message : error.toString();\r\n        this.error = errMsg;\r\n        this.changeDetectorRef.detectChanges();\r\n        return throwError(errMsg);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n    }\r\n}\r\n"],"sourceRoot":""}