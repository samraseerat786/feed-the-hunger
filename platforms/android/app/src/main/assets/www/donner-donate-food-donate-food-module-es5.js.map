{"version":3,"sources":["./src/app/donner/donate-food/donate-food.page.html","./src/app/donner/donate-food/donate-food.module.ts","./src/app/donner/donate-food/donate-food.page.scss","./src/app/donner/donate-food/donate-food.page.ts"],"names":[],"mappings":"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","file":"donner-donate-food-donate-food-module-es5.js","sourcesContent":["module.exports = \"<ion-header class=\\\"ion-text-center\\\">\\r\\n    <ion-toolbar color=\\\"secondary\\\">\\r\\n        <ion-buttons slot=\\\"start\\\">\\r\\n            <ion-back-button></ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <ion-title>Donate Food</ion-title>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n    <form [formGroup]=\\\"donateFoodForm\\\">\\r\\n        <ion-grid>\\r\\n            <ion-row class=\\\"ion-justify-content-center\\\">\\r\\n                <ion-col class=\\\"ion-align-self-center\\\" size-md=\\\"9\\\" size-lg=\\\"8\\\" size-xl=\\\"6\\\" size-xs=\\\"12\\\" size-sm=\\\"10\\\">\\r\\n                    <div class=\\\"ion-text-center\\\">\\r\\n                        <h3>Provide Food Information</h3>\\r\\n                    </div>\\r\\n                    <div class=\\\"ion-padding\\\">\\r\\n                        <ion-item>\\r\\n                            <ion-input placeholder=\\\"Enter Name\\\" formControlName=\\\"name\\\"></ion-input>\\r\\n                        </ion-item>\\r\\n                        <ion-item>\\r\\n                            <ion-datetime placeholder=\\\"Expiry Date\\\" pickerFormat=\\\"YYYY MM DD\\\"\\r\\n                                          formControlName=\\\"expiry_date\\\"></ion-datetime>\\r\\n                        </ion-item>\\r\\n                        <ion-item>\\r\\n                            <ion-label position=\\\"floating\\\">Select Type</ion-label>\\r\\n                            <ion-select formControlName=\\\"type\\\" placeholder=\\\"--Select--\\\" okText=\\\"Okay\\\"\\r\\n                                        cancelText=\\\"Dismiss\\\">\\r\\n                                <ion-select-option value=\\\"fast Food\\\">Fast Food</ion-select-option>\\r\\n                                <ion-select-option value=\\\"rise\\\">Rise</ion-select-option>\\r\\n                                <ion-select-option value=\\\"simple food\\\">Simple Food</ion-select-option>\\r\\n                            </ion-select>\\r\\n                        </ion-item>\\r\\n                        <ion-item>\\r\\n                            <ion-input placeholder=\\\"Quantity\\\" formControlName=\\\"quantity\\\"></ion-input>\\r\\n                        </ion-item>\\r\\n                        <ion-item>\\r\\n                            <ion-label position=\\\"floating\\\">Unit</ion-label>\\r\\n                            <ion-select formControlName=\\\"unit\\\" placeholder=\\\"--Select--\\\" okText=\\\"Okay\\\"\\r\\n                                        cancelText=\\\"Dismiss\\\">\\r\\n                                <ion-select-option *ngFor=\\\"let item of units\\\"\\r\\n                                                   value=\\\"{{item}}\\\">{{item}}</ion-select-option>\\r\\n                            </ion-select>\\r\\n                        </ion-item>\\r\\n                        <ion-item>\\r\\n                            <ion-label id=\\\"food_image\\\" color=\\\"primary\\\" stacked>Food Image</ion-label>\\r\\n                            <ion-input type=\\\"file\\\" accept=\\\"image/*\\\" id=\\\"upload\\\"\\r\\n                                       (change)=\\\"imageFileChanged($event)\\\"></ion-input>\\r\\n                        </ion-item>\\r\\n                    </div>\\r\\n                    <div class=\\\"ion-padding\\\">\\r\\n                        <ion-button size=\\\"default\\\" [disabled]=\\\"donateFoodForm.invalid\\\"\\r\\n                                    (click)=\\\"uploadImageAndFoodDonation()\\\"\\r\\n                                    color=\\\"primary\\\" type=\\\"submit\\\" expand=\\\"block\\\">Donate Food\\r\\n                        </ion-button>\\r\\n                    </div>\\r\\n                </ion-col>\\r\\n            </ion-row>\\r\\n        </ion-grid>\\r\\n    </form>\\r\\n</ion-content>\\r\\n\"","import {NgModule} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\r\nimport {Routes, RouterModule} from '@angular/router';\r\n\r\nimport {IonicModule} from '@ionic/angular';\r\n\r\nimport {DonateFoodPage} from './donate-food.page';\r\n\r\nconst routes: Routes = [\r\n    {\r\n        path: '',\r\n        component: DonateFoodPage\r\n    }\r\n];\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        IonicModule,\r\n        RouterModule.forChild(routes),\r\n        ReactiveFormsModule\r\n    ],\r\n    declarations: [DonateFoodPage]\r\n})\r\nexport class DonateFoodPageModule {\r\n}\r\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2Rvbm5lci9kb25hdGUtZm9vZC9kb25hdGUtZm9vZC5wYWdlLnNjc3MifQ== */\"","import {Component, OnInit} from '@angular/core';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {HttpClient} from '@angular/common/http';\r\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {Observable} from 'rxjs';\r\nimport {ListService} from '../../services/list.service';\r\nimport {UtilsService} from \"../../services/utils.service\";\r\nimport * as firebase from 'firebase';\r\nimport {AngularFireStorage} from \"@angular/fire/storage\";\r\n\r\n@Component({\r\n    selector: 'app-donate-food',\r\n    templateUrl: './donate-food.page.html',\r\n    styleUrls: ['./donate-food.page.scss'],\r\n})\r\nexport class DonateFoodPage implements OnInit {\r\n    private charityID;\r\n    donateFoodForm: FormGroup;\r\n    data: Observable<any>;\r\n    units: string [] = ['grams', 'kilo grams', 'dozen', 'pieces'];\r\n    charityHouse: any;\r\n    today = new Date();\r\n    date;\r\n    finalDonationObject;\r\n    dateTill;\r\n    foodImage;\r\n\r\n    constructor(private utils: UtilsService,\r\n                private route: ActivatedRoute,\r\n                private http: HttpClient,\r\n                private formBuilder: FormBuilder,\r\n                private service: ListService,\r\n                private router: Router, public db: AngularFireStorage) {\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.route.paramMap.subscribe(paramMap => {\r\n            this.charityID = paramMap.get('id');\r\n        });\r\n        this.formInitializer();\r\n        // this.today.setDate(this.today.getDate() + 3);\r\n        this.dateTill = this.today.toISOString().substr(0, 10);\r\n    }\r\n\r\n    formInitializer() {\r\n        this.donateFoodForm = this.formBuilder.group({\r\n            name: [null, Validators.compose([Validators.maxLength(50), Validators.pattern('[a-zA-Z ]*'), Validators.required])],\r\n            expiry_date: [null, [Validators.required]],\r\n            type: [null, [Validators.required]],\r\n            quantity: [null, Validators.compose([Validators.pattern('[0-9 ]*'), Validators.required])],\r\n            unit: [null, Validators.required]\r\n        });\r\n    }\r\n\r\n    async imageFileChanged(e) {\r\n        this.foodImage = e.target.files[0];\r\n    }\r\n\r\n    async uploadImageAndFoodDonation() {\r\n        if (!this.foodImage) {\r\n            alert(\"Please select a food image...\");\r\n            return;\r\n        }\r\n        const donner = JSON.parse(localStorage.getItem('user'));\r\n        let fileName = `${Date.now()}.png`;\r\n        const filePath = `food-images/${donner.id}/${fileName}`;\r\n        const storageRef = this.db.ref(filePath);\r\n        await this.utils.presentLoading(\"Please wait...\");\r\n        await this.db.upload(filePath, this.foodImage).then(async (snapshot) => {\r\n            await storageRef.getDownloadURL().subscribe(downloadURL => {\r\n                this.donateFood(downloadURL);\r\n            });\r\n        });\r\n    }\r\n\r\n    async donateFood(imageUrl) {\r\n        this.date = this.today.getFullYear() + '-' + (this.today.getMonth() + 1) + '-' + this.today.getDate();\r\n        const test = this.donateFoodForm.value;\r\n        // const dateFromForm = test.expiry_date.getFullYear() + '-' + (test.expiry_date.getMonth() + 1 ) + '-' + test.expiry_date.getDate();\r\n        const dateFormat = test.expiry_date.split('T')[0];\r\n        // This id will comes from the service, because when user will login, his ID will save to service\r\n        // and retrieved at time of send data to server.\r\n        const donner = JSON.parse(localStorage.getItem('user'));\r\n        const donnerID = donner.id;\r\n        this.finalDonationObject = '{\"quantityValue\" : \"' + test.quantity + '\",' +\r\n            '\"quantityUnit\" : \"' + test.unit + '\",' +\r\n            '\"foodItem\": {' +\r\n            '\"name\": \"' + test.name + '\",' +\r\n            '\"expiry_date\": \"' + dateFormat + '\",' +\r\n            '\"type\": \"' + test.type + '\" },' +\r\n            '\"donation\": {' + '\"date\": \"' + this.date + '\",' +\r\n            '\"donner\": {' + '\"id\": ' + donnerID + ' },' +\r\n            '\"charityHouse\": {' + '\"id\": ' + this.charityID + ' }}}';\r\n        const foodDonation = JSON.parse(this.finalDonationObject);\r\n        foodDonation.foodItem.image = imageUrl;\r\n        foodDonation.donation.acceptanceTime = \"not added yet\";\r\n        foodDonation.donation.status = \"new\";\r\n        this.saveFoodDonation(foodDonation).subscribe(data => {\r\n                this.utils.stopLoading();\r\n                this.utils.presentAlert('Notification sent. Please! wait while charity house connect with you. Thanks for donating fund.');\r\n                this.router.navigate(['charityList']);\r\n            },\r\n            error => {\r\n                this.utils.stopLoading();\r\n            });\r\n    }\r\n\r\n    saveFoodDonation(dataObj): Observable<any> {\r\n        const url = `${this.service.homeUrl}/foodDonationDetails/newFoodDonationDetails`;\r\n        return this.http.post(url, dataObj);\r\n    }\r\n}\r\n"],"sourceRoot":""}